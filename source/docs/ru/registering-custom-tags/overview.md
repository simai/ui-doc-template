---
extends: _core._layouts.documentation
section: content
title: 'Пользовательские теги Markdown — обзор'
description: 'Пользовательские теги Markdown — обзор'
---

# Пользовательские теги Markdown — обзор

На этой странице представлены наши **пользовательский тег Markdown** system: компоненты уровня блока, разделенные `!type` и `!endtype` маркеры, реализованные поверх League CommonMark и подключенные к Jigsaw.

---

## Что такое пользовательские теги?

Пользовательские теги можно использовать повторно **Компоненты блока** рендерится из Markdown с использованием лаконичного синтаксиса:

```md
!<type> [attributes]
...inner markdown content...
!end<type>
```

Они идеально подходят для выносок, примеров, встраиваемых элементов и любого структурированного контента, который должен оставаться удобным для автора, создавая при этом согласованный HTML.

---

## Анатомия метки

* **Открытый маркер**: `!<type>` в начале линии; может включать встроенные атрибуты.
* **Закрыть маркер**: `!end<type>` в начале строки.
* **Внутреннее наполнение**: анализируется как Markdown в HTML, а затем внедряется в элемент-оболочку тега.
* **Обертка**:по умолчанию `<div>`, конфигурируемый по тегу VIA `htmlTag()`.

> Вложенность **одинаковый** Тип тега разрешен по умолчанию и может быть отключен через `allowNestingSame()`.

---

## Синтаксис атрибутов (краткий)

Характеристики на опоре открытой линии:

* Пары ключ–значение в кавычках или без кавычек: `key="value"`, `key:'value'`, `key=value`
* Сокращения: `.class` Присоединяется к `class`, `#id` Задает `id`
* Несколько классов объединяются и **дедупликация**
* Пробелы в Юникоде и смарт-кавычки нормализованы для надежного синтаксического анализа

> Для каждого тега `attrsFilter()` может очищать/преобразовывать атрибуты перед рендерингом.

---

## Быстрый старт

1. **Создание класса тегов** который расширяется `BaseTag` и возвращает уникальный `type()`.
2. **Регистрировать** имя класса в `config.php` В соответствии с `tags`массив.
3. **Создание сайта** Поэтому Jigsaw подхватывает реестр и наш пользовательский парсер.

---

## Минимальный пример

### PHP (определение тегов)

```php
namespace App\Helpers\CustomTags;

use App\Helpers\CommonMark\BaseTag;

final class ExampleTag extends BaseTag
{
    public function type(): string { return 'example'; }

    public function baseAttrs(): array
    {
        return ['class' => 'example overflow-hidden radius-1/2 overflow-x-auto'];
    }
}
```

### Markdown (использование)

```md
!example .mb-4.border
**Inside** the example tag.
!endexample
```

### HTML (упрощенный результат)

```html
<div class="example overflow-hidden radius-1/2 overflow-x-auto mb-4 border">
  <p><strong>Inside</strong> the example tag.</p>
</div>
```

---

## Поток рендеринга (высокий уровень)

1. **Сканировать**: универсальные парсеры соответствуют `openRegex()` / `closeRegex()` с каждой зарегистрированной метки.
2. **Захват**: все, что находится между маркерами, становится внутренним Markdown тега.
3. **Разбирать **: внутренний Markdown → HTML.
4. **Атрибуты**: parse и **сливать** Встроенные атрибуты с `baseAttrs()`; необязательный `attrsFilter()` Работает.
5. **Передавать**:использование `renderer()` при наличии; в противном случае выдают `<htmlTag ...attrs>innerHtml</htmlTag>`.

---

## Интеграция с пазлом (резюме)

* Классы тегов живут в `App\Helpers\CustomTags` и продлить `BaseTag`.
* Короткие имена классов перечислены в `config.php => tags`.
* `bootstrap.php` связывает реестр тегов и меняет местами стандартный парсер Jigsaw с нашим `Parser`, который устанавливает метод `CustomTagExtension` для CommonMark.

> Смотрите специальную страницу **Регистрация пользовательских тегов** для получения точных сниппетов конфигурации.

---

## Что можно и чего нельзя делать

**От**

* Хранить `baseAttrs()` семантический и минимальный
* Использование `attrsFilter()` для нормализации/внесения в белый список
* Обеспечивать `renderer()` Только когда нужен полный контроль

**Не надо**

* Жесткое кодирование представления, которое авторы могут захотеть переопределить
* Полагайтесь на хрупкие форматы атрибутов — отдавайте предпочтение толерантному синтаксическому анализу

---

## FAQ (быстрый)

* **Могу ли я вкладывать бирки?** Да. Однотипная вложенность может быть отключена с помощью `allowNestingSame()`.
* **Как изменить элемент-оболочку?** Перекрыть `htmlTag()` в классе тегов.
* **Как добавить классы по умолчанию?** Вернуть их из `baseAttrs()`; Классы author объединяются и дедуплицируются.

