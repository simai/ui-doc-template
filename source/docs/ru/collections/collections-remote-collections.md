---
extends: _core._layouts.documentation
section: content
title: 'Удаленные коллекции'
description: 'Удаленные коллекции'
---

# Удаленные коллекции

В дополнение к использованию файлов Markdown или Blade для элементов коллекции, вы можете возвращать элементы коллекции непосредственно из
тем `collections`массив в `config.php`. Это позволяет создавать элементы программным способом, например, можно получить
элементы из удаленного источника, такого как внешний API или системы управления контентом на основе API, такие как Contentful, GraphCMS или
DatoCMS.

---

## Построение предметов коллекции в config.php

Для любой коллекции элементы могут быть построены путем возврата массива или коллекции `items` из конфигурации коллекции
массив в `config.php`. Каждый элемент должен быть массивом; Ключи элемента будут преобразованы в переменные страницы (такие как
те, которые обычно отображаются в YAML-заголовке файла Markdown), в то время как значение параметра `content` ключ послужит
в качестве содержимого элемента коллекции. Это содержимое будет проанализировано как Markdown и, таким образом, может содержать либо Markdown, либо
HTML-контент; он будет доступен в ваших шаблонах Blade с помощью `@yield('content')` или эхом `{!! $page->
getContent() !!}`:

> config.php
```php 
return [
'collections' => [
'posts' => [
'extends' => '_layouts.post',
'items' => [
[
'title' => 'Title of my first post',
'content' => '## The first post content',
],
[
'title' => 'Title of my second post',
'content' => '## The second post content',
],
],
],
],
];
```
> _layouts/post.blade.php
```blade 
@extends('_layouts.master')

@section('body')
<h1>{{ $page->title }}</h1>

    @yield('content')

@endsection
```

Под капотом Jigsaw будет:

1. Создать файл `_tmp` в каталоге коллекции (например, `source/_posts/_tmp`) для хранения временных файлов Markdown для
Каждый элемент удаленной коллекции
2. Обрабатывайте временные файлы так, как если бы они были `*.blade.md` Файлы
3. Удалите временные файлы в следующих случаях: `jigsaw build` является полным

В дополнение к `content`, в каждом элементе может быть указан параметр `filename` , который будет использоваться в качестве имени временного Markdown
файл. Если оно опущено, имя файла по умолчанию будет соответствовать имени коллекции, за которым следует индекс, поэтому `post-1.blade.md`,
`post-2.blade.md`и так далее. В результате получается `path` выходного файла будет обработан в соответствии с обычными правилами для
Коллекции.

В качестве альтернативы, метод `items` массив может содержать простые строковые значения, которые будут обрабатываться как содержимое Markdown элемента,
без переменных страницы:

> config.php
```php 
return [
'collections' => [
'posts' => [
'extends' => '_layouts.post',
'items' => [
'## The content for post 1',
'## The content for post 2',
'## The content for post 3',
],
],
],
];
```
---

## Получение элементов коллекции из удаленного API
Тем `items` Введите ключ `config.php` Может также ссылаться на замыкание, которое возвращает массив или коллекцию элементов. С помощью функции
closure, элементы коллекции могут быть получены откуда угодно — из удаленного API, из других мест в файловой системе или собраны
вверх программно. Полученные данные затем могут быть преобразованы перед созданием элементов коллекции. Например:

> config.php
```php 
return [
'collections' => [
'posts' => [
'extends' => '_layouts.post',
'items' => function ($config) {
$posts = json_decode(file_get_contents('https://jsonplaceholder.typicode.com/posts'));

                return collect($posts)->map(function ($post) {
                    return [
                        'title' => $post->title,
                        'content' => $post->body,
                    ];
                });
            },
        ],
    ],

];
```

Если вы хотите, чтобы удаленный API вызывался только при сборке для определенных сред, вы можете разместить метод `items` замыкание
в соответствующем `config.{environment}.php` файл. Например, чтобы получить доступ к удаленному API только во время работы `build
production`, создайте файл config.production.php и включите в него свой файл `items` Закрытие там. Это предотвратит потенциально длительное
Время сборки во время работы `build local` в разработке.

Тем `items` Замыкание получает метод `config` массив в качестве параметра, поэтому вы также можете ссылаться на другие значения конфигурации (например,
URL API) внутри замыкания.
